self.requestFileSystemSync=self.webkitRequestFileSystemSync||self.requestFileSystemSync,self.importScripts("requester-tools.js"),self.requester={},function(){function a(){self.requestFileSystemSync&&(f=f||self.requestFileSystemSync(TEMPORARY,e.SIZEFILES)),self.tools.factoryError(d)}function b(a){try{if(!f)return self.tools.sendRequest(a);let b=new Response(f.root.getFile(a.name,e.READ).file(),{status:200});return self.tools.getResult(a,b)}catch(b){if(-1<b.toString().includes("NotFoundError"))return self.tools.sendRequest(a);self.tools.error(b,a.name)}}function c(){var a=f.root.createReader(),b=a.readEntries();for(var c in b)b[c].remove()}function d(){}let e={SIZEFILES:10485760,READ:{create:0},WRITE:{create:1}},f=null;this.getSavedFile=b,this.saveFile=function(a,b){return b.clone().blob().then(function(c){let d,g=f.root.getFile(a.name,e.WRITE);return a.date=new Date,g.remove(),g=f.root.getFile(a.name,e.WRITE),d=g.createWriter(),d.write(c),self.tools.getResult(a,b)}).catch(self.tools.error)},this.removeAll=c,this.initFileSystem=a}.apply(self.requester),self.addEventListener("message",function(a){let b=a.data;b.useFS&&(self.requester.initFileSystem(),b.saveFile=self.requester.saveFile,b.getSavedFile=self.requester.getSavedFile),self.tools.constants.FILES_SERVER=b.filesServerToUpdate,self.tools.getFile(b).then(a=>{self.postMessage(a)},a=>{self.postMessage(a)})});