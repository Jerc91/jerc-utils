self.requestFileSystemSync=self.webkitRequestFileSystemSync||self.requestFileSystemSync,self.importScripts('requester-tools.js'),self.requester={},function(){function d(){}let h={SIZEFILES:10485760,READ:{create:0},WRITE:{create:1}},i=null;this.getSavedFile=function(e){try{if(!i)return self.tools.sendRequest(e);let a=new Response(i.root.getFile(e.name,h.READ).file(),{status:200});return self.tools.getResult(e,a)}catch(a){if(-1<a.toString().includes('NotFoundError'))return self.tools.sendRequest(e);self.tools.error(a,e.name)}},this.saveFile=function(b,a){return a.clone().blob().then((function(c){let d,e=i.root.getFile(b.name,h.WRITE);return b.date=new Date,e.remove(),e=i.root.getFile(b.name,h.WRITE),d=e.createWriter(),d.write(c),self.tools.getResult(b,a)})).catch(self.tools.error)},this.removeAll=function(){var c=i.root.createReader(),a=c.readEntries();for(var b in a)a[b].remove()},this.initFileSystem=function(){self.requestFileSystemSync&&(i=i||self.requestFileSystemSync(TEMPORARY,h.SIZEFILES)),self.tools.factoryError(d)}}.apply(self.requester),self.addEventListener('message',(function(c){let a=c.data;a.useFS&&(self.requester.initFileSystem(),a.saveFile=self.requester.saveFile,a.getSavedFile=self.requester.getSavedFile),self.tools.getFile(a).then((b)=>{self.postMessage(b)},(b)=>{self.postMessage(b)})}));